{"ast":null,"code":"import _regeneratorRuntime from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{lazy,Suspense}from'react';import{Box,Container,Grid,Typography,InputAdornment,Stack,TextField,IconButton}from'@mui/material';import{useTranslation}from'react-i18next';import{useLocation}from'react-router-dom';import{ResultSkelton,EmptyCard,ButtonPrimary,CameraScan}from'../../components';import{commonAction}from'../../redux/commonSlice';import{useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import{fetchData,getDate,isNullOrEmpty,submitForm}from'../../functions';import{getScanDataURL,downloadURL}from'../../api';import SearchIcon from'@mui/icons-material/Search';import QrCode2Icon from'@mui/icons-material/QrCode2';import styles from\"./ResultPage.module.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var width=window.innerWidth;var height=(width<=479?window.innerHeight-175:window.innerHeight-215)+\"px\";var ResultCard=/*#__PURE__*/lazy(function(){return import('../../components/Card/Result/ResultCard');});var ResultPage=function ResultPage(){////// Basic Data\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEmpty=_useState4[0],setIsEmpty=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),search=_useState6[0],setSearch=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];////// Dispatch\nvar dispatch=useDispatch();////// Handle Camera\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openCamera=_useState10[0],setOpenCamera=_useState10[1];////// Navigate\nvar navigate=useNavigate();////// Translate\nvar _useTranslation=useTranslation(),t=_useTranslation.t;var skeltonRows=[1,2,3,4];////// Get Data From Homepage\nvar location=useLocation();var _location$state=location===null||location===void 0?void 0:location.state,plantCode=_location$state.plantCode,locCode=_location$state.locCode,locName=_location$state.locName,whCode=_location$state.whCode;//////Camera Option\nvar handleOpenCamera=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setOpenCamera(true);case 1:case\"end\":return _context.stop();}},_callee);}));return function handleOpenCamera(){return _ref.apply(this,arguments);};}();var handleCloseCamera=function handleCloseCamera(){setOpenCamera(function(prev){return false;});};var handleScanSuccess=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(decodedText,decodedResult){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(isNullOrEmpty(decodedText)){_context2.next=3;break;}_context2.next=3;return fetchDownload(downloadURL,{ARG_TYPE:\"Q_SCAN\",ARG_EMPID:\"\",ARG_WH:whCode,ARG_SCAN:decodedText,OUT_CURSOR:\"\"},\"scan_qr\");case 3:case\"end\":return _context2.stop();}},_callee2);}));return function handleScanSuccess(_x,_x2){return _ref2.apply(this,arguments);};}();///// Handle Download\nvar fetchDownload=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(url,dataConfig,type){var result,_result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:result=null;_context3.t0=type;_context3.next=_context3.t0===\"scan-qr\"?4:_context3.t0===\"scan-data\"?9:18;break;case 4:_context3.next=6;return fetchData(url,dataConfig);case 6:result=_context3.sent;if(result){if(((_result=result)===null||_result===void 0?void 0:_result.length)>0){alert(result);//navigate(\"/scan-result\", {state: {plantCode: result[0].PLANT_CD, locCode: result[0].CODE, locName: result[0].NAME, whCode: lastLogin.WH_CD}});\n}else{handleCloseCamera();dispatch(commonAction.setTypeNotice(\"qr-error\"));dispatch(commonAction.openNotice());}}else{dispatch(commonAction.setTypeNotice(\"connect-failed\"));dispatch(commonAction.openNotice());}return _context3.abrupt(\"break\",19);case 9:setIsEmpty(function(prevData){return false;});setSearch(function(prevData){return\"\";});_context3.next=13;return submitForm(true);case 13:_context3.next=15;return fetchData(url,dataConfig);case 15:result=_context3.sent;if(result){if(result.length>1){result.shift();setData(function(prevData){return result;});setFilter(function(prevData){return result;});}else{setData(function(prevData){return null;});setFilter(function(prevData){return null;});setIsEmpty(function(prevData){return true;});}}else{setData(function(prevData){return null;});setFilter(function(prevData){return null;});setIsEmpty(function(prevData){return true;});}return _context3.abrupt(\"break\",19);case 18:return _context3.abrupt(\"break\",19);case 19:case\"end\":return _context3.stop();}},_callee3);}));return function fetchDownload(_x3,_x4,_x5){return _ref3.apply(this,arguments);};}();useEffect(function(){if((location===null||location===void 0?void 0:location.state)===null||isNullOrEmpty(plantCode)||isNullOrEmpty(locCode)||isNullOrEmpty(locName)||isNullOrEmpty(whCode)){navigate(\"/\",{replace:true});}else{fetchDownload(getScanDataURL,{V_P_SCAN:\"Q_WH\",V_P_TYPE:\"\",V_P_PLANT_CD:plantCode,V_P_WH_CD:whCode,V_P_PART_GROUP:\"ALL\",V_P_PART_CD:\"\",V_P_YMD:getDate(),V_P_LOC_WH:locCode,V_P_USER:\"\",V_P_IP:\"\",OUT_CURSOR:\"\"},\"scan-data\");}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);///// Handle Back Home\nvar handleClick=function handleClick(){navigate(\"/\",{replace:true});};///// Handle Filter\nvar handleFilter=function handleFilter(event){setSearch(function(prevData){return event.target.value;});var _input=event.target.value.toUpperCase();var filtered=data.filter(function(item){return item.PART_GROUP.toUpperCase().includes(_input)||item.PART.toUpperCase().includes(_input);});setFilter(function(prevData){return filtered;});if(filtered===null||filtered.length===0){setIsEmpty(function(prevData){return true;});}else{setIsEmpty(function(prevData){return false;});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{className:styles[\"s-home-5\"],children:[/*#__PURE__*/_jsx(Box,{className:styles[\"s-home-content\"],children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Box,{className:styles[\"s-form-content\"],children:/*#__PURE__*/_jsxs(Box,{sx:{width:\"100%\",minHeight:height},children:[/*#__PURE__*/_jsxs(Box,{className:styles[\"b-card-3\"],children:[/*#__PURE__*/_jsx(Typography,{className:styles[\"b-title\"],children:locName}),/*#__PURE__*/_jsx(Typography,{className:styles[\"b-desc\"],children:t('wh_result_desc')})]}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(Stack,{marginBottom:3,children:/*#__PURE__*/_jsx(TextField,{label:\"\",inputProps:{inputMode:'text'},className:styles[\"b-input\"],placeholder:t('pl_search'),value:search,onChange:handleFilter,name:\"SEARCH\",color:\"info\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(SearchIcon,{})})},fullWidth:true})})}),!isEmpty&&/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1.5,className:styles[\"s-list\"],children:[filter!==null&&(filter===null||filter===void 0?void 0:filter.length)>0&&filter.map(function(item,index){return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,className:styles[\"s-list_item\"],children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(ResultSkelton,{}),children:/*#__PURE__*/_jsx(ResultCard,{order:item.STT,title:item.PART_GROUP,desc:item.PART,status:item.ORDER_PART.toUpperCase(),safeQty:item.SAFETY_INV,stockQty:item.STOCK_QTY,last:index===filter.length-1})})},index);}),filter==null&&skeltonRows.map(function(item,index){return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(ResultSkelton,{})},index);})]}),isEmpty&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(EmptyCard,{}),/*#__PURE__*/_jsx(Box,{className:styles[\"s-bot\"],children:/*#__PURE__*/_jsx(ButtonPrimary,{title:t('btn_go_hom'),handleClick:handleClick,name:\"go-back\"})})]})]})})})}),/*#__PURE__*/_jsx(IconButton,{className:styles[\"s-fixed\"],onClick:handleOpenCamera,\"aria-label\":\"scan\",children:/*#__PURE__*/_jsx(QrCode2Icon,{sx:{fontSize:35}})})]}),openCamera&&/*#__PURE__*/_jsx(CameraScan,{open:openCamera,handleSuccess:handleScanSuccess,handleClose:handleCloseCamera})]});};export default ResultPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}