{"ast":null,"code":"import _regeneratorRuntime from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as React from\"react\";import{useState,useEffect}from\"react\";import{TextField,Typography,Box,Stack}from\"@mui/material\";import{useNavigate}from\"react-router-dom\";import InputAdornment from\"@mui/material/InputAdornment\";import PersonOutlineOutlinedIcon from\"@mui/icons-material/PersonOutlineOutlined\";import LockOutlinedIcon from'@mui/icons-material/LockOutlined';import VisibilityIcon from'@mui/icons-material/Visibility';import VisibilityOffIcon from'@mui/icons-material/VisibilityOff';import{ButtonPrimary,SelectItem}from\"../../components\";import{ModalNotice,ModalRegister,ModalLoading}from\"../../components/Modal\";import{useSelector,useDispatch}from\"react-redux\";import{useTranslation}from'react-i18next';import{commonAction}from'../../redux/commonSlice';import{encode as base64_encode}from\"base-64\";import styles from\"./LoginPage.module.scss\";import loginImage from\"../../assets/images/thumbs/banner.png\";import{fetchData}from\"../../functions\";import{signinURL,downloadURL,userURL}from\"../../api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var height=window.innerHeight+\"px\";var LoginPage=function LoginPage(){///// Basic Data\nvar lastLogin=localStorage.getItem(\"lastLoginWH\")===null?null:JSON.parse(localStorage.getItem(\"lastLoginWH\"));var _useState=useState({WH_CD:lastLogin?lastLogin.WH_CD:\"\",EMP_ID:lastLogin?lastLogin.EMP_ID:\"\",PASS:\"\"}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),whData=_useState4[0],setWhData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showPass=_useState6[0],setShowPass=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),open=_useState8[0],setOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openLoad=_useState10[0],setOpenLoad=_useState10[1];////// Translate\nvar _useTranslation=useTranslation(),t=_useTranslation.t;///// Navigate\nvar navigate=useNavigate();var dispatch=useDispatch();////// Open Modal\nvar openNotice=useSelector(function(state){return state.common.openNotice;});var typeNotice=useSelector(function(state){return state.common.typeNotice;});////// Handle Modal Notice\nvar handleCloseNotice=function handleCloseNotice(){dispatch(commonAction.closeNotice());};////// Handle Events\nvar handleClick=function handleClick(){setShowPass(function(showPass){return!showPass;});};var handleCloseReg=function handleCloseReg(){setOpen(function(open){return!open;});};//////// Handle Set Controlled Data\nvar handleChange=function handleChange(event){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},event.target.name,event.target.value));});};////// Handle Login\nvar handleSignIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:fetchDownload(signinURL,{ARG_TYPE:\"Q\",ARG_EMPID:data.EMP_ID,ARG_PASS:data.PASS===data.EMP_ID?data.PASS:base64_encode(data.PASS),ARG_WH:data.WH_CD,OUT_CURSOR:\"\"},\"login\");case 1:case\"end\":return _context.stop();}},_callee);}));return function handleSignIn(){return _ref.apply(this,arguments);};}();var fetchDownload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(url,dataConfig,type){var result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchData(url,dataConfig);case 2:result=_context2.sent;if(!result){_context2.next=28;break;}if(!(result.length>0)){_context2.next=20;break;}_context2.t0=type;_context2.next=_context2.t0===\"warehouse\"?8:_context2.t0===\"login\"?11:_context2.t0===\"user\"?13:17;break;case 8:setWhData(function(prevData){return result;});///// Deault Warehouse: IT\nsetData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{WH_CD:'10'});});return _context2.abrupt(\"break\",18);case 11:handleLoginCases(result[0].NAME);return _context2.abrupt(\"break\",18);case 13:sessionStorage.setItem(\"userDataWH\",JSON.stringify(result[0]));localStorage.setItem(\"lastLoginWH\",JSON.stringify({EMP_ID:result[0].EMPID,WH_CD:data.WH_CD}));navigate(\"/\");return _context2.abrupt(\"break\",18);case 17:return _context2.abrupt(\"break\",18);case 18:_context2.next=26;break;case 20:_context2.t1=type;_context2.next=_context2.t1===\"warehouse\"?23:25;break;case 23:setWhData(function(prevData){return null;});return _context2.abrupt(\"break\",26);case 25:return _context2.abrupt(\"break\",26);case 26:_context2.next=30;break;case 28:dispatch(commonAction.setTypeNotice(\"connect-failed\"));dispatch(commonAction.openNotice());case 30:case\"end\":return _context2.stop();}},_callee2);}));return function fetchDownload(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();///// Login Cases\nvar handleLoginCases=function handleLoginCases(type){switch(type){case\"INVALID_USER\":dispatch(commonAction.setTypeNotice(\"invalid_user\"));dispatch(commonAction.openNotice());break;case\"INVALID_WH\":dispatch(commonAction.setTypeNotice(\"invalid_warehouse\"));dispatch(commonAction.openNotice());break;case\"INVALID_PASSWORD\":dispatch(commonAction.setTypeNotice(\"invalid_pass\"));dispatch(commonAction.openNotice());break;case\"CHANGE_PASSWORD\":setOpen(function(open){return true;});break;case\"LOGIN_SUCCESS\":handleNavigate();break;default:break;}};var handleNavigate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setOpen(function(open){return false;});setOpenLoad(function(openLoad){return true;});_context3.next=4;return submitForm(true);case 4:setOpenLoad(function(openLoad){return false;});fetchDownload(userURL,{V_P_TYPE:\"ESMS_LOGIN\",V_P_EMPID:data.EMP_ID,V_P_PASSWORD:\"\",OUT_CURSOR:\"\"},\"user\");case 6:case\"end\":return _context3.stop();}},_callee3);}));return function handleNavigate(){return _ref3.apply(this,arguments);};}();function submitForm(result){// Pretend it's hitting the network.\nreturn new Promise(function(resolve,reject){setTimeout(function(){if(result){resolve();}else{reject();}},2000);});}////// Default Events\nuseEffect(function(){fetchDownload(downloadURL,{ARG_TYPE:\"Q_WH\",ARG_EMPID:\"\",ARG_WH:\"\",ARG_SCAN:\"\",OUT_CURSOR:\"\"},\"warehouse\");// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);////// Handle Select\nvar handleSelect=function handleSelect(name,value){setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,value));});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Box,{className:styles[\"s-layout\"],sx:{width:\"100%\",minHeight:height},children:/*#__PURE__*/_jsx(Box,{className:styles[\"b-box\"],children:/*#__PURE__*/_jsxs(Box,{className:styles[\"s-form\"],children:[/*#__PURE__*/_jsxs(Box,{className:styles[\"p-title\"],children:[\"Sparepart \",/*#__PURE__*/_jsx(\"span\",{children:\"WH Management\"})]}),/*#__PURE__*/_jsx(Box,{className:styles[\"b-thumb\"],children:/*#__PURE__*/_jsx(\"img\",{src:loginImage,alt:\"Login\"})}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(Stack,{marginBottom:1.5,children:/*#__PURE__*/_jsx(SelectItem,{title:t('warehouse'),name:\"WH_CD\",data:whData,placeholder:\"Ch\\u1ECDn kho h\\xE0ng\",cValue:data.WH_CD,handleEvent:handleSelect,isValidate:true,message:\"D\\u1EEF li\\u1EC7u kh\\xF4ng \\u0111\\u01B0\\u1EE3c \\u0111\\u1EC3 tr\\u1ED1ng\"})}),/*#__PURE__*/_jsx(Stack,{marginBottom:1.5,children:/*#__PURE__*/_jsx(TextField,{label:\"User ID\",inputProps:{inputMode:'numeric',pattern:'[0-9]*'},className:styles[\"b-input\"],placeholder:\"Nh\\u1EADp m\\xE3 th\\u1EBB\",value:data.EMP_ID,onChange:handleChange,name:\"EMP_ID\",color:\"info\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(PersonOutlineOutlinedIcon,{})})},fullWidth:true})}),/*#__PURE__*/_jsxs(Stack,{marginBottom:1.5,children:[/*#__PURE__*/_jsx(TextField,{label:\"Password\",type:showPass?\"text\":\"password\",inputProps:{inputMode:'text'},className:styles[\"b-input\"],placeholder:\"Nh\\u1EADp m\\u1EADt kh\\u1EA9u\",value:data.PASS,onChange:handleChange,name:\"PASS\",color:\"info\",InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(LockOutlinedIcon,{})}),endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",sx:{paddingLeft:1.5},onClick:handleClick,children:showPass?/*#__PURE__*/_jsx(VisibilityOffIcon,{}):/*#__PURE__*/_jsx(VisibilityIcon,{})})},fullWidth:true}),/*#__PURE__*/_jsx(Typography,{className:styles[\"s-validate\"],children:\"Password and ID is same for first time login\"})]}),/*#__PURE__*/_jsx(Box,{className:styles[\"s-bot\"],children:/*#__PURE__*/_jsx(ButtonPrimary,{title:t('login'),handleClick:handleSignIn,name:\"key\"})})]})]})})}),/*#__PURE__*/_jsx(ModalNotice,{open:openNotice,handleClose:handleCloseNotice,type:typeNotice}),/*#__PURE__*/_jsx(ModalRegister,{open:open,handleClose:handleCloseReg,baseData:data.EMP_ID,handleNavigate:handleNavigate}),/*#__PURE__*/_jsx(ModalLoading,{open:openLoad})]});};export default LoginPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}