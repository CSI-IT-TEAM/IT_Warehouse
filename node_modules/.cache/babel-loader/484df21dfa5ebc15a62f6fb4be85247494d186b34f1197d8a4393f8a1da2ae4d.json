{"ast":null,"code":"import _regeneratorRuntime from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/React JS/Projects/Warehouse Management/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import{Box,Container,Typography}from'@mui/material';import{FormInput,ButtonPrimary}from'../../components';import{useTranslation}from'react-i18next';import{useDispatch,useSelector}from'react-redux';import{commonAction}from'../../redux/commonSlice';import{validData}from'../../data';import{isNullOrEmpty,fetchData}from'../../functions';import{signinURL,updateUserURL}from'../../api';import{encode as base64_encode}from\"base-64\";import styles from\"./UserPage.module.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var width=window.innerWidth;var height=(width<=479?window.innerHeight-175:window.innerHeight-215)+\"px\";var LoginPage=function LoginPage(){////// Basic Data\nvar _useState=useState({OLD_PASS:\"\",NEW_PASS:\"\",CONFIRM_PASS:\"\"}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(validData),_useState4=_slicedToArray(_useState3,2),validate=_useState4[0],setValidate=_useState4[1];var lang=useSelector(function(state){return state.common.lang;});///// User Data\nvar _userData=JSON.parse(sessionStorage.getItem('userDataWH'));////// Translate\nvar _useTranslation=useTranslation(),t=_useTranslation.t;var dispatch=useDispatch();///////Handle Change Text Field\nvar handleChange=function handleChange(event){var _name=event.target.name;var _value=event.target.value;handleSetValidate(_name,isNullOrEmpty(_value)?false:true);if(_name===\"NEW_PASS\"){if(data.CONFIRM_PASS!==_value){handleSetValidate(\"CONFIRM_PASS\",false,\"Confirm data and new password must be the same\",\"Dữ liệu xác nhận phải giống với mật khẩu mới\");}else{handleSetValidate(\"CONFIRM_PASS\",true,\"This field data is required\",\"Dữ liệu không được rỗng\");}}if(_name===\"CONFIRM_PASS\"){if(data.NEW_PASS!==_value){handleSetValidate(\"CONFIRM_PASS\",false,\"Confirm data and new password must be the same\",\"Dữ liệu xác nhận phải giống với mật khẩu mới\");}else{handleSetValidate(\"CONFIRM_PASS\",true,\"This field data is required\",\"Dữ liệu không được rỗng\");}}setData(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},_name,_value));});};///// Handle Confirm\nvar handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _validate,_userCheck,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return handleValidate();case 2:_validate=_context.sent;if(!_validate){_context.next=21;break;}_context.next=6;return fetchData(signinURL,{ARG_TYPE:\"Q_CHECK\",ARG_EMPID:_userData.EMPID,ARG_PASS:base64_encode(data.OLD_PASS),ARG_WH:\"\",OUT_CURSOR:\"\"});case 6:_userCheck=_context.sent;if(!(_userCheck&&_userCheck.length>0)){_context.next=19;break;}if(!(_userCheck[0].RES_YN===\"Y\")){_context.next=15;break;}_context.next=11;return fetchData(updateUserURL,{ARG_TYPE:\"Q_UPDATE\",ARG_EMPID:_userData.EMPID,ARG_PASS:base64_encode(data.NEW_PASS)});case 11:result=_context.sent;if(result){dispatch(commonAction.setTypeNotice(\"success\"));dispatch(commonAction.openNotice());setData(function(prevData){return{OLD_PASS:\"\",NEW_PASS:\"\",CONFIRM_PASS:\"\"};});}else{dispatch(commonAction.setTypeNotice(\"error\"));dispatch(commonAction.openNotice());}_context.next=17;break;case 15:dispatch(commonAction.setTypeNotice(\"error_pass\"));dispatch(commonAction.openNotice());case 17:_context.next=21;break;case 19:dispatch(commonAction.setTypeNotice(\"connect-failed\"));dispatch(commonAction.openNotice());case 21:case\"end\":return _context.stop();}},_callee);}));return function handleClick(){return _ref.apply(this,arguments);};}();//////// Handle Validate\nvar handleSetValidate=function handleSetValidate(name,value){var messageEN=arguments.length>2&&arguments[2]!==undefined?arguments[2]:\"\";var messageVN=arguments.length>3&&arguments[3]!==undefined?arguments[3]:\"\";setValidate(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,{validate:value,messageEN:isNullOrEmpty(messageEN)?validate[name].messageEN:messageEN,messageVN:isNullOrEmpty(messageVN)?validate[name].messageVN:messageVN}));});};var handleValidate=function handleValidate(){var _result=true;if(isNullOrEmpty(data.OLD_PASS)){_result=false;handleSetValidate(\"OLD_PASS\",false);}else{handleSetValidate(\"OLD_PASS\",true);}if(isNullOrEmpty(data.NEW_PASS)){_result=false;handleSetValidate(\"NEW_PASS\",false);}else{handleSetValidate(\"NEW_PASS\",true);}if(isNullOrEmpty(data.CONFIRM_PASS)){_result=false;handleSetValidate(\"CONFIRM_PASS\",false);}else{handleSetValidate(\"CONFIRM_PASS\",true);}if(!isNullOrEmpty(data.NEW_PASS)&&!isNullOrEmpty(data.CONFIRM_PASS)){if(data.NEW_PASS!==data.CONFIRM_PASS){_result=false;handleSetValidate(\"CONFIRM_PASS\",false,\"Confirm data and new password must be the same\",\"Dữ liệu xác nhận phải giống với mật khẩu mới\");}else{handleSetValidate(\"CONFIRM_PASS\",true,\"This field data is required\",\"Dữ liệu không được rỗng\");}}return _result;};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Box,{className:styles['s-home-3'],children:/*#__PURE__*/_jsx(Box,{className:styles['s-home-content'],children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Box,{className:styles['s-form-content'],children:/*#__PURE__*/_jsxs(Box,{sx:{width:\"100%\",minHeight:height},children:[/*#__PURE__*/_jsxs(Box,{className:styles['b-card-3'],children:[/*#__PURE__*/_jsx(Typography,{className:styles['b-title'],children:t('change_title')}),/*#__PURE__*/_jsx(Typography,{className:styles['b-desc'],children:t('change_desc')})]}),/*#__PURE__*/_jsxs(Box,{className:styles['s-form'],children:[/*#__PURE__*/_jsx(FormInput,{title:t('frm_oldpass'),placeholder:t('pl_oldpass'),value:data.OLD_PASS,isDefault:true,name:\"OLD_PASS\",disable:false,handleEvent:handleChange,isImportant:true,inputProp:{inputMode:'text'},isValidate:validate.OLD_PASS.validate,message:lang===\"en\"?validate.OLD_PASS.messageEN:validate.OLD_PASS.messageVN}),/*#__PURE__*/_jsx(FormInput,{title:t('frm_newpass'),placeholder:t('pl_newpass'),value:data.NEW_PASS,isDefault:true,name:\"NEW_PASS\",disable:false,handleEvent:handleChange,isImportant:true,inputProp:{inputMode:'text'},isValidate:validate.NEW_PASS.validate,message:lang===\"en\"?validate.NEW_PASS.messageEN:validate.NEW_PASS.messageVN}),/*#__PURE__*/_jsx(FormInput,{title:t('frm_confirmpass'),placeholder:t('pl_confirmpass'),value:data.CONFIRM_PASS,isDefault:true,name:\"CONFIRM_PASS\",disable:false,handleEvent:handleChange,isImportant:true,inputProp:{inputMode:'text'},isValidate:validate.CONFIRM_PASS.validate,message:lang===\"en\"?validate.CONFIRM_PASS.messageEN:validate.CONFIRM_PASS.messageVN})]}),/*#__PURE__*/_jsx(Box,{className:styles['s-bot'],children:/*#__PURE__*/_jsx(ButtonPrimary,{title:t('btn_confirm'),handleClick:handleClick,name:\"pass\"})})]})})})})})});};export default LoginPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}